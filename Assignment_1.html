<!DOCTYPE html>
<html>
<head>
<!-- Initialize a global WBK function -->
<script src="https://cdn.rawgit.com/maxlath/wikidata-sdk/dist/dist/wikibase-sdk.min.js"></script>
<!-- Initialize a global wdk object using the WBK object -->
<script src="https://cdn.rawgit.com/maxlath/wikidata-sdk/dist/dist/wikidata-sdk.min.js"></script>
<!-- Initialize the d3js library -->
<script src="https://d3js.org/d3.v5.js"></script>
</head>

<body>
  <pre id="output"></pre>
	
  <script>
  
  
    query = `SELECT ?taxon ?taxonLabel ?count
			WITH {
				SELECT ?taxon (COUNT(DISTINCT ?proteins) AS ?count) WHERE {
					?proteins wdt:P31 wd:Q8054 ;
							  wdt:P703 ?taxon .
				}			GROUP BY ?taxon
							ORDER BY DESC(?count)
							LIMIT 10
			} AS %RESULTS WHERE {
			  INCLUDE %RESULTS
			  SERVICE wikibase:label {
				bd:serviceParam wikibase:language '[AUTO_LANGUAGE],en' .
			  }
			}`
    
	fetch(
      wdk.sparqlQuery(query)
    ).then( response => response.json()
    ).then( wdk.simplify.sparqlResults
    ).then(
      function (response) {
		dataJSON   = response;
        dataSTRING = JSON.stringify(response, undefined, 2);
		data = []
		data.child = dataJSON
		
      }
    )
  </script>
</body>

</html>
